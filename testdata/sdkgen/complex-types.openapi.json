{
  "openapi": "3.2.0",
  "info": { "title": "Complex API", "version": "1.0.0" },
  "paths": {
    "/items": {
      "get": {
        "operationId": "listItems",
        "x-tsgonest-controller": "ItemsController",
        "x-tsgonest-method": "listItems",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Item" }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Item": {
        "type": "object",
        "required": ["id", "type", "status"],
        "properties": {
          "id": { "type": "string" },
          "type": { "$ref": "#/components/schemas/ItemType" },
          "status": { "$ref": "#/components/schemas/ItemStatus" },
          "metadata": { "$ref": "#/components/schemas/Metadata" },
          "tags": {
            "type": "array",
            "items": { "type": "string" }
          }
        }
      },
      "ItemType": {
        "oneOf": [
          { "$ref": "#/components/schemas/PhysicalItem" },
          { "$ref": "#/components/schemas/DigitalItem" }
        ],
        "discriminator": {
          "propertyName": "kind",
          "mapping": {
            "physical": "#/components/schemas/PhysicalItem",
            "digital": "#/components/schemas/DigitalItem"
          }
        }
      },
      "PhysicalItem": {
        "type": "object",
        "required": ["kind", "weight"],
        "properties": {
          "kind": { "type": "string", "const": "physical" },
          "weight": { "type": "number" }
        }
      },
      "DigitalItem": {
        "type": "object",
        "required": ["kind", "downloadUrl"],
        "properties": {
          "kind": { "type": "string", "const": "digital" },
          "downloadUrl": { "type": "string" }
        }
      },
      "ItemStatus": {
        "type": "string",
        "enum": ["active", "inactive", "archived"]
      },
      "Metadata": {
        "type": "object",
        "additionalProperties": { "type": "string" }
      },
      "NullableField": {
        "anyOf": [
          { "type": "string" },
          { "type": "null" }
        ]
      }
    }
  }
}

package codegen

// formatRegexes maps format names to their JavaScript regex patterns for validation.
// Based on typia's FormatCheatSheet.ts which itself references ajv-formats.
// Special entries:
//   - "password": empty string (no validation â€” any string passes)
//   - "regex": empty string (uses try/catch, not regex)
var formatRegexes = map[string]string{
	// Special characters
	"byte":     `^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$`,
	"password": "", // no validation
	"regex":    "", // uses try/catch
	"uuid":     `^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$`,

	// Addresses
	"email":         `^[a-z0-9!#$%&'*+/=?^_` + "`" + `{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_` + "`" + `{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$`,
	"hostname":      `^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$`,
	"idn-email":     `^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$`,
	"idn-hostname":  `^([a-z0-9\u00a1-\uffff0-9]+(-[a-z0-9\u00a1-\uffff0-9]+)*\.)+[a-z\u00a1-\uffff]{2,}$`,
	"iri":           `^[A-Za-z][\d+\-.A-Za-z]*:[^\u0000-\u0020"<>\\^` + "`" + `{|}]*$`,
	"iri-reference": `^[A-Za-z][\d+\-.A-Za-z]*:[^\u0000-\u0020"<>\\^` + "`" + `{|}]*$`,
	"ipv4":          `^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$`,
	"ipv6":          `^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1?\d\d?)(\.(25[0-5]|2[0-4]\d|1?\d\d?)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1?\d\d?)(\.(25[0-5]|2[0-4]\d|1?\d\d?)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1?\d\d?)(\.(25[0-5]|2[0-4]\d|1?\d\d?)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1?\d\d?)(\.(25[0-5]|2[0-4]\d|1?\d\d?)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1?\d\d?)(\.(25[0-5]|2[0-4]\d|1?\d\d?)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1?\d\d?)(\.(25[0-5]|2[0-4]\d|1?\d\d?)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1?\d\d?)(\.(25[0-5]|2[0-4]\d|1?\d\d?)){3}))|:)))$`,
	"url":           `^(?:https?|ftp):\/\/[^\s/$.?#].[^\s]*$`,
	"uri":           `^[A-Za-z][\d+\-.A-Za-z]*:[^\s]*$`,
	"uri-reference": `^(?:[A-Za-z][\d+\-.A-Za-z]*:)?(?:\/\/[^\s/]*)?[^\s]*$`,
	"uri-template":  `^(?:(?:[^\x00-\x20"'<>%\\^` + "`" + `{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$`,

	// Timestamps
	"date-time": `^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])(T|\s)([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]{1,9})?(Z|[+-]([01][0-9]|2[0-3]):[0-5][0-9])$`,
	"date":      `^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$`,
	"time":      `^([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]{1,9})?(Z|[+-]([01][0-9]|2[0-3]):[0-5][0-9])$`,
	"duration":  `^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$`,

	// Pointers
	"json-pointer":          `^(?:\/(?:[^~/]|~0|~1)*)*$`,
	"relative-json-pointer": `^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$`,

	// Additional formats (Zod 4 parity)
	"nanoid":    `^[A-Za-z0-9_-]{21}$`,
	"cuid":      `^c[a-z0-9]{24}$`,
	"cuid2":     `^[a-z][a-z0-9]{23,}$`,
	"ulid":      `^[0-9A-HJKMNP-TV-Z]{26}$`,
	"jwt":       `^[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]*$`,
	"base64url": `^[A-Za-z0-9_-]*=?=?$`,
	"hex":       `^[0-9a-fA-F]+$`,
	"mac":       `^(?:[0-9A-Fa-f]{2}[:-]){5}[0-9A-Fa-f]{2}$`,
	"cidrv4":    `^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\/(?:3[0-2]|[12]?\d)$`,
	"cidrv6":    `^(([0-9a-f]{1,4}:){7}[0-9a-f]{1,4}|([0-9a-f]{1,4}:){1,7}:|([0-9a-f]{1,4}:){1,6}:[0-9a-f]{1,4}|([0-9a-f]{1,4}:){1,5}(:[0-9a-f]{1,4}){1,2}|([0-9a-f]{1,4}:){1,4}(:[0-9a-f]{1,4}){1,3}|([0-9a-f]{1,4}:){1,3}(:[0-9a-f]{1,4}){1,4}|([0-9a-f]{1,4}:){1,2}(:[0-9a-f]{1,4}){1,5}|[0-9a-f]{1,4}:((:[0-9a-f]{1,4}){1,6})|:((:[0-9a-f]{1,4}){1,7}|:)|fe80:(:[0-9a-f]{0,4}){0,4}%[0-9a-zA-Z]+|::(ffff(:0{1,4})?:)?((25[0-5]|(2[0-4]|1?[0-9])?[0-9])\.){3}(25[0-5]|(2[0-4]|1?[0-9])?[0-9])|([0-9a-f]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1?[0-9])?[0-9])\.){3}(25[0-5]|(2[0-4]|1?[0-9])?[0-9]))\/(?:12[0-8]|1[01]\d|[1-9]?\d)$`,
	"emoji":     `^(\p{Emoji_Presentation}|\p{Extended_Pictographic})+$`,
}

// formatFlags maps format names to the JavaScript regex flags they require.
var formatFlags = map[string]string{
	"uuid":         "i",
	"email":        "i",
	"hostname":     "i",
	"idn-hostname": "i",
	"date-time":    "i",
	"time":         "i",
	"uri-template": "i",
	"ipv6":         "i",
	"url":          "i",
	"cidrv6":       "i",
	"hex":          "i",
	"mac":          "i",
	"emoji":        "u",
}

// FormatNames returns all supported format names.
func FormatNames() []string {
	names := make([]string, 0, len(formatRegexes))
	for name := range formatRegexes {
		names = append(names, name)
	}
	return names
}
